- hosts: all
  gather_facts: false
  tasks:
   - name: install docker
     become: true  
     command: "{{item}}" 
     with_items:
      - dnf config-manager --add-repo=https://download.docker.com/linux/centos/docker-ce.repo
      - dnf install docker-ce-20.10.6-3.el8 -y
      - systemctl enable docker
      - systemctl start docker
      
   - name: configurar repo de kubernetes
     become: true
     ansible.builtin.lineinfile:
       path: /etc/yum.repos.d/kubernetes.repo
       backup: yes
       line: "{{item}}"
       create: yes
       state: present
     with_items:
        - "[kubernetes]"
        - "name=Kubernetes"
        - "baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64"
        - "enabled=1"
        - "gpgcheck=1"
        - "repo_gpgcheck=1"
        - "gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg"
        - "exclude=kubelet kubeadm kubectl"
        - "EOF"
   
   - name: install and active kubernetes
     become: true  
     command: "{{item}}" 
     with_items:
      - "dnf install -y kubelet kubeadm kubectl --disableexcludes=kubernetes"
      - "systemctl enable kubelet"
      - "systemctl start kubelet"
  

 
 
 
 
 

      
  
  
  
    
    
    
