- hosts: master
  gather_facts: false
  tasks:
  # con el m칩dulo de k8s me daba connection refused, he optado por crear el namespace desde linea de comandos.
  # si el namespace ya existiera, hago que no se pare la ejecuci칩n de las task a침adiendo un ignore_errors
  # creamos un namespace
  - name: Create namespace 
    become: true
    shell: kubectl create namespace webapp-volumes
    ignore_errors: yes
   
  # intento ejecutar el deployment con el m칩dulo de k8s pero no encuentra el fichero en local: Does the file exist?"}
  # opto por copiar el archivo al nodo destino y ejecutarlo desde la shell
  #- name: Create a Deployment by reading the definition from a local file
  #  become: true
  #  community.kubernetes.k8s:
  #    state: present
  #    src: "./nfs-pv.yaml"
  
  # copiamos nfs-pv-yaml al directorio de master
  - name: Copy nfs-pv.yaml to master
    become: true
    copy:
      src: nfs-pv.yaml 
      dest: ./
  
  # aplicamos nfs-pv
  - name: Apply nfs-pv.yaml
    become: true
    shell: kubectl apply -f nfs-pv.yaml
    
  # copiamos nfs-pvc.yaml al directorio de master
  - name: Copy nfs-pvc.yaml to master
    become: true
    copy:
      src: nfs-pvc.yaml 
      dest: ./
  
  # aplicamos nfs-pvc
  - name: Apply nfs-pvc.yaml
    become: true
    shell: kubectl apply -f nfs-pvc.yaml
    
  # copiamos webapp-volumes.yaml al directorio de master
  - name: Copy webapp-volumes.yaml to master
    become: true
    copy:
      src: webapp-volumes.yaml 
      dest: ./
  
  # aplicamos webapp-volumes
  - name: Apply webapp-volumes.yaml
    become: true
    shell: kubectl apply -f webapp-volumes.yaml
  
     
  
    
    
    
       
       
